### 为什么要异步
promise解决了js中的异步处理问题，那为什么要有异步呢？  
首先因为js是单线程的语言，因此，JavaScript在同一个时间只能做一件事，单线程意味着，如果在同个时间有多个任务的话，这些任务就需要进行排队，
前一个任务执行完，才会执行下一个任务。  
如果前一个任务的执行时间很长，比如文件的读取操作或ajax操作，后一个任务就不得不等着，拿ajax来说，当用户向后台获取大量的数据时，不得不等到
所有数据都获取完毕才能进行下一步操作，用户只能在那里干等着，严重影响用户体验。  
这时候异步任务就出现了，异步任务是指不进入主线程，而进入任务队列的任务，只有任务队列通知主线程，某个异步任务可以执行了，该任务才会进入主
线程，当我们打开网站时，像图片的加载，音乐的加载，其实就是一个异步任务。  
异步任务的机制的实现可以基于上一篇event loop理解，自己脑子中也有一个概念。  
### 回调函数
回调函数的意思是，一个函数被作为一个参数传递到另一个函数里，在那个函数执行完后再执行。  
这里要注意回调函数和异步没有直接关系，一般的回调是同步回调，在特殊函数中的回调才是异步回调；加入一个函数回调在setTimeout中的第一个参数，
那么这个回调就是异步的；  
又比如ajxa请求：
```javascript
var xhr = new XMLHttpRequest();
xhr.open('POST', url, true);   //第三个参数决定是否采用异步的方式
xhr.send(data);
xhr.onreadystatechange = function(){
    if(xhr.readystate === 4 && xhr.status === 200){
       ///do something
    }
}
```
ajax教程中有句话：XMLHttpRequest 对象如果要用于 AJAX 的话，其 open() 方法的 async 参数必须设置为 true；  
当使用 async=true 时，请规定在响应处于 onreadystatechange 事件中的就绪状态时执行的函数；  
onreadystatechange就是ajax中的事件回调。  
回调地域：就是请求需要上一个请求中返回的值作为参数j进行请求
```javascript
// queryData 为ajax封装的请求
queryData('data1', function(ret) {
  console.log(ret)　　　// 按顺序第一个输出为：hi
  queryData('data2', function(ret) {
    console.log(ret)　　//按顺序第二个输出为：hello
    queryData('data3', function(ret) {
      console.log(ret)　　// 按顺序第三个输出为：nihao
    });
  });
});
```
#### 事件监听、发布订阅也可以实现回调
[js处理异步的几种方法](https://www.cnblogs.com/zuobaiquan01/p/8477322.html)

### Promise
