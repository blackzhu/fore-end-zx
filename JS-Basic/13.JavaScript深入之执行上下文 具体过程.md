# 前言
在准备工作完成后开始分析代码具体执行过程

## 具体执行分析
分析代码：

```javascript
var scope = "global scope";
function checkscope(){
    var scope = "local scope";
    function f(){
        return scope;
    }
    return f();
}
checkscope();
```

执行过程如下：

1.首先执行全局代码，创建全局执行上下文，创建即入执行上下文栈ECStack;

2.初始化全局执行上下文；

2.初始化的同时遇到checkscope函数被创建，这时候保存作用域链到checkscope函数的内部[[scope]]属性；

深入作用域链中就提到作用域链在函数保存在函数定义的时候就确定了

3.开始执行checkscope函数

在执行上下文栈中提到执行上下文：当执行到一个函数的时候，就会进行准备工作，这里的“准备工作”，让我们用个更
专业一点的说法，就叫做"执行上下文

这时候就会创建函数执行上下文，创建即入执行上下文栈ECStack;

4.初始化check函数的执行上下文

  * 1.首先复制函数 [[scope]] 属性创建作用域链，
  
  * 2.在变量对象中提到，进入执行上下文也就是初始化的时候变量对象(VO)转变为了活动对象(AO)，通过函数的 arguments 属性初始化创建
  
  * 3.在进入执行上下文时，变量对象初始化创建后，会给变量对象添加形参、函数声明、变量声明等初始的属性值
  
  * 4.将活动对象压入 checkscope 作用域链顶端。
  
同时玉带 f 函数被创建，保存作用域链到 f 函数的内部属性[[scope]]

5.执行 f 函数，创建 f 函数执行上下文，f 函数执行上下文被压入执行上下文栈，创建即入执行上下文栈ECStack

6.f 函数执行上下文初始化, 以下跟第 4 步相同：

7.f 函数执行，沿着作用域链查找 scope 值，返回 scope 值

8.f 函数执行完毕，f 函数上下文从执行上下文栈中弹出

9.checkscope 函数执行完毕，checkscope 执行上下文从执行上下文栈中弹出



  
